"""
    Sudoku solver using python-optimized version of dancing links algorithm. Needs Python 2.7+ for set comprehensions.

    Biggest problem with this algorithm - reasonably hard puzzles are solved under 200ms on my local MBP.
    Not sure how testing script would measure it with just one iteration, as python startup time is significantly
    higher than actual solving time. For easier puzzles, it takes less than 1ms to solve and time won't catch
    a difference.

    Resources:
        https://en.wikipedia.org/wiki/Exact_cover
        https://en.wikipedia.org/wiki/Dancing_Links

    Author: https://github.com/mrjoes/
"""

NINE = range(9)
NINExNINE = range(9*9)


def dump(results):
    return ''.join([str(n + 1) for n in results])


def cover(columns, rows, v):
    cols = []

    for j in rows[v]:
        for i in columns[j]:
            for k in rows[i]:
                if k != j:
                    columns[k].remove(i)

        cols.append(columns.pop(j))

    return cols


def uncover(columns, rows, v, cols):
    for j in reversed(rows[v]):
        columns[j] = cols.pop()

        for i in columns[j]:
            for k in rows[i]:
                if k != j:
                    columns[k].add(i)


def gen_matrix():
    columns = {
        0: {0, 1, 2, 3, 4, 5, 6, 7, 8},
        1: {9, 10, 11, 12, 13, 14, 15, 16, 17}, 2: {18, 19, 20, 21, 22, 23, 24, 25, 26}, 3: {32, 33, 34, 35, 27, 28, 29, 30, 31},
        4: {36, 37, 38, 39, 40, 41, 42, 43, 44}, 5: {45, 46, 47, 48, 49, 50, 51, 52, 53}, 6: {54, 55, 56, 57, 58, 59, 60, 61, 62},
        7: {64, 65, 66, 67, 68, 69, 70, 71, 63}, 8: {72, 73, 74, 75, 76, 77, 78, 79, 80}, 9: {81, 82, 83, 84, 85, 86, 87, 88, 89},
        10: {96, 97, 98, 90, 91, 92, 93, 94, 95}, 11: {99, 100, 101, 102, 103, 104, 105, 106, 107}, 12: {108, 109, 110, 111, 112, 113, 114, 115, 116},
        13: {117, 118, 119, 120, 121, 122, 123, 124, 125}, 14: {128, 129, 130, 131, 132, 133, 134, 126, 127}, 15: {135, 136, 137, 138, 139, 140, 141, 142, 143},
        16: {144, 145, 146, 147, 148, 149, 150, 151, 152}, 17: {160, 161, 153, 154, 155, 156, 157, 158, 159}, 18: {162, 163, 164, 165, 166, 167, 168, 169, 170},
        19: {171, 172, 173, 174, 175, 176, 177, 178, 179}, 20: {180, 181, 182, 183, 184, 185, 186, 187, 188}, 21: {192, 193, 194, 195, 196, 197, 189, 190, 191},
        22: {198, 199, 200, 201, 202, 203, 204, 205, 206}, 23: {207, 208, 209, 210, 211, 212, 213, 214, 215}, 24: {224, 216, 217, 218, 219, 220, 221, 222, 223},
        25: {225, 226, 227, 228, 229, 230, 231, 232, 233}, 26: {234, 235, 236, 237, 238, 239, 240, 241, 242}, 27: {243, 244, 245, 246, 247, 248, 249, 250, 251},
        28: {256, 257, 258, 259, 260, 252, 253, 254, 255}, 29: {261, 262, 263, 264, 265, 266, 267, 268, 269}, 30: {270, 271, 272, 273, 274, 275, 276, 277, 278},
        31: {279, 280, 281, 282, 283, 284, 285, 286, 287}, 32: {288, 289, 290, 291, 292, 293, 294, 295, 296}, 33: {297, 298, 299, 300, 301, 302, 303, 304, 305},
        34: {306, 307, 308, 309, 310, 311, 312, 313, 314}, 35: {320, 321, 322, 323, 315, 316, 317, 318, 319}, 36: {324, 325, 326, 327, 328, 329, 330, 331, 332},
        37: {333, 334, 335, 336, 337, 338, 339, 340, 341}, 38: {342, 343, 344, 345, 346, 347, 348, 349, 350}, 39: {352, 353, 354, 355, 356, 357, 358, 359, 351},
        40: {360, 361, 362, 363, 364, 365, 366, 367, 368}, 41: {369, 370, 371, 372, 373, 374, 375, 376, 377}, 42: {384, 385, 386, 378, 379, 380, 381, 382, 383},
        43: {387, 388, 389, 390, 391, 392, 393, 394, 395}, 44: {396, 397, 398, 399, 400, 401, 402, 403, 404}, 45: {405, 406, 407, 408, 409, 410, 411, 412, 413},
        46: {416, 417, 418, 419, 420, 421, 422, 414, 415}, 47: {423, 424, 425, 426, 427, 428, 429, 430, 431}, 48: {432, 433, 434, 435, 436, 437, 438, 439, 440},
        49: {448, 449, 441, 442, 443, 444, 445, 446, 447}, 50: {450, 451, 452, 453, 454, 455, 456, 457, 458}, 51: {459, 460, 461, 462, 463, 464, 465, 466, 467},
        52: {468, 469, 470, 471, 472, 473, 474, 475, 476}, 53: {480, 481, 482, 483, 484, 485, 477, 478, 479}, 54: {486, 487, 488, 489, 490, 491, 492, 493, 494},
        55: {495, 496, 497, 498, 499, 500, 501, 502, 503}, 56: {512, 504, 505, 506, 507, 508, 509, 510, 511}, 57: {513, 514, 515, 516, 517, 518, 519, 520, 521},
        58: {522, 523, 524, 525, 526, 527, 528, 529, 530}, 59: {531, 532, 533, 534, 535, 536, 537, 538, 539}, 60: {544, 545, 546, 547, 548, 540, 541, 542, 543},
        61: {549, 550, 551, 552, 553, 554, 555, 556, 557}, 62: {558, 559, 560, 561, 562, 563, 564, 565, 566}, 63: {567, 568, 569, 570, 571, 572, 573, 574, 575},
        64: {576, 577, 578, 579, 580, 581, 582, 583, 584}, 65: {585, 586, 587, 588, 589, 590, 591, 592, 593}, 66: {594, 595, 596, 597, 598, 599, 600, 601, 602},
        67: {608, 609, 610, 611, 603, 604, 605, 606, 607}, 68: {612, 613, 614, 615, 616, 617, 618, 619, 620}, 69: {621, 622, 623, 624, 625, 626, 627, 628, 629},
        70: {630, 631, 632, 633, 634, 635, 636, 637, 638}, 71: {640, 641, 642, 643, 644, 645, 646, 647, 639}, 72: {648, 649, 650, 651, 652, 653, 654, 655, 656},
        73: {657, 658, 659, 660, 661, 662, 663, 664, 665}, 74: {672, 673, 674, 666, 667, 668, 669, 670, 671}, 75: {675, 676, 677, 678, 679, 680, 681, 682, 683},
        76: {684, 685, 686, 687, 688, 689, 690, 691, 692}, 77: {693, 694, 695, 696, 697, 698, 699, 700, 701}, 78: {704, 705, 706, 707, 708, 709, 710, 702, 703},
        79: {711, 712, 713, 714, 715, 716, 717, 718, 719}, 80: {720, 721, 722, 723, 724, 725, 726, 727, 728}, 81: {0, 36, 72, 9, 45, 18, 54, 27, 63},
        82: {64, 1, 37, 73, 10, 46, 19, 55, 28}, 83: {65, 2, 38, 74, 11, 47, 20, 56, 29}, 84: {66, 3, 39, 75, 12, 48, 21, 57, 30},
        85: {67, 4, 40, 76, 13, 49, 22, 58, 31}, 86: {32, 68, 5, 41, 77, 14, 50, 23, 59}, 87: {33, 69, 6, 42, 78, 15, 51, 24, 60},
        88: {34, 70, 7, 43, 79, 16, 52, 25, 61}, 89: {35, 71, 8, 44, 80, 17, 53, 26, 62}, 90: {99, 135, 108, 144, 81, 117, 153, 90, 126},
        91: {100, 136, 109, 145, 82, 118, 154, 91, 127}, 92: {128, 101, 137, 110, 146, 83, 119, 155, 92}, 93: {129, 102, 138, 111, 147, 84, 120, 156, 93},
        94: {130, 103, 139, 112, 148, 85, 121, 157, 94}, 95: {131, 104, 140, 113, 149, 86, 122, 158, 95}, 96: {96, 132, 105, 141, 114, 150, 87, 123, 159},
        97: {160, 97, 133, 106, 142, 115, 151, 88, 124}, 98: {161, 98, 134, 107, 143, 116, 152, 89, 125}, 99: {225, 162, 198, 234, 171, 207, 180, 216, 189},
        100: {226, 163, 199, 235, 172, 208, 181, 217, 190}, 101: {227, 164, 200, 236, 173, 209, 182, 218, 191}, 102: {192, 228, 165, 201, 237, 174, 210, 183, 219},
        103: {193, 229, 166, 202, 238, 175, 211, 184, 220}, 104: {194, 230, 167, 203, 239, 176, 212, 185, 221}, 105: {195, 231, 168, 204, 240, 177, 213, 186, 222},
        106: {196, 232, 169, 205, 241, 178, 214, 187, 223}, 107: {224, 197, 233, 170, 206, 242, 179, 215, 188}, 108: {288, 261, 297, 270, 306, 243, 279, 315, 252},
        109: {289, 262, 298, 271, 307, 244, 280, 316, 253}, 110: {290, 263, 299, 272, 308, 245, 281, 317, 254}, 111: {291, 264, 300, 273, 309, 246, 282, 318, 255},
        112: {256, 292, 265, 301, 274, 310, 247, 283, 319}, 113: {320, 257, 293, 266, 302, 275, 311, 248, 284}, 114: {321, 258, 294, 267, 303, 276, 312, 249, 285},
        115: {322, 259, 295, 268, 304, 277, 313, 250, 286}, 116: {323, 260, 296, 269, 305, 278, 314, 251, 287}, 117: {387, 324, 360, 396, 333, 369, 342, 378, 351},
        118: {352, 388, 325, 361, 397, 334, 370, 343, 379}, 119: {353, 389, 326, 362, 398, 335, 371, 344, 380}, 120: {354, 390, 327, 363, 399, 336, 372, 345, 381},
        121: {355, 391, 328, 364, 400, 337, 373, 346, 382}, 122: {356, 392, 329, 365, 401, 338, 374, 347, 383}, 123: {384, 357, 393, 330, 366, 402, 339, 375, 348},
        124: {385, 358, 394, 331, 367, 403, 340, 376, 349}, 125: {386, 359, 395, 332, 368, 404, 341, 377, 350}, 126: {450, 423, 459, 432, 468, 405, 441, 477, 414},
        127: {451, 424, 460, 433, 469, 406, 442, 478, 415}, 128: {416, 452, 425, 461, 434, 470, 407, 443, 479}, 129: {480, 417, 453, 426, 462, 435, 471, 408, 444},
        130: {481, 418, 454, 427, 463, 436, 472, 409, 445}, 131: {482, 419, 455, 428, 464, 437, 473, 410, 446}, 132: {483, 420, 456, 429, 465, 438, 474, 411, 447},
        133: {448, 484, 421, 457, 430, 466, 439, 475, 412}, 134: {449, 485, 422, 458, 431, 467, 440, 476, 413}, 135: {513, 549, 486, 522, 558, 495, 531, 504, 540},
        136: {514, 550, 487, 523, 559, 496, 532, 505, 541}, 137: {515, 551, 488, 524, 560, 497, 533, 506, 542}, 138: {516, 552, 489, 525, 561, 498, 534, 507, 543},
        139: {544, 517, 553, 490, 526, 562, 499, 535, 508}, 140: {545, 518, 554, 491, 527, 563, 500, 536, 509}, 141: {546, 519, 555, 492, 528, 564, 501, 537, 510},
        142: {547, 520, 556, 493, 529, 565, 502, 538, 511}, 143: {512, 548, 521, 557, 494, 530, 566, 503, 539}, 144: {576, 612, 585, 621, 594, 630, 567, 603, 639},
        145: {640, 577, 613, 586, 622, 595, 631, 568, 604}, 146: {641, 578, 614, 587, 623, 596, 632, 569, 605}, 147: {642, 579, 615, 588, 624, 597, 633, 570, 606},
        148: {643, 580, 616, 589, 625, 598, 634, 571, 607}, 149: {608, 644, 581, 617, 590, 626, 599, 635, 572}, 150: {609, 645, 582, 618, 591, 627, 600, 636, 573},
        151: {610, 646, 583, 619, 592, 628, 601, 637, 574}, 152: {611, 647, 584, 620, 593, 629, 602, 638, 575}, 153: {675, 711, 648, 684, 720, 657, 693, 666, 702},
        154: {676, 712, 649, 685, 721, 658, 694, 667, 703}, 155: {704, 677, 713, 650, 686, 722, 659, 695, 668}, 156: {705, 678, 714, 651, 687, 723, 660, 696, 669},
        157: {706, 679, 715, 652, 688, 724, 661, 697, 670}, 158: {707, 680, 716, 653, 689, 725, 662, 698, 671}, 159: {672, 708, 681, 717, 654, 690, 726, 663, 699},
        160: {673, 709, 682, 718, 655, 691, 727, 664, 700}, 161: {674, 710, 683, 719, 656, 692, 728, 665, 701}, 162: {0, 162, 324, 486, 648, 81, 243, 405, 567},
        163: {1, 163, 325, 487, 649, 82, 244, 406, 568}, 164: {2, 164, 326, 488, 650, 83, 245, 407, 569}, 165: {3, 165, 327, 489, 651, 84, 246, 408, 570},
        166: {4, 166, 328, 490, 652, 85, 247, 409, 571}, 167: {5, 167, 329, 491, 653, 86, 248, 410, 572}, 168: {6, 168, 330, 492, 654, 87, 249, 411, 573},
        169: {7, 169, 331, 493, 655, 88, 250, 412, 574}, 170: {8, 170, 332, 494, 656, 89, 251, 413, 575}, 171: {576, 9, 171, 333, 495, 657, 90, 252, 414},
        172: {577, 10, 172, 334, 496, 658, 91, 253, 415}, 173: {416, 578, 11, 173, 335, 497, 659, 92, 254}, 174: {417, 579, 12, 174, 336, 498, 660, 93, 255},
        175: {256, 418, 580, 13, 175, 337, 499, 661, 94}, 176: {257, 419, 581, 14, 176, 338, 500, 662, 95}, 177: {96, 258, 420, 582, 15, 177, 339, 501, 663},
        178: {97, 259, 421, 583, 16, 178, 340, 502, 664}, 179: {98, 260, 422, 584, 17, 179, 341, 503, 665}, 180: {99, 261, 423, 585, 18, 180, 342, 504, 666},
        181: {100, 262, 424, 586, 19, 181, 343, 505, 667}, 182: {101, 263, 425, 587, 20, 182, 344, 506, 668}, 183: {102, 264, 426, 588, 21, 183, 345, 507, 669},
        184: {103, 265, 427, 589, 22, 184, 346, 508, 670}, 185: {104, 266, 428, 590, 23, 185, 347, 509, 671}, 186: {672, 105, 267, 429, 591, 24, 186, 348, 510},
        187: {673, 106, 268, 430, 592, 25, 187, 349, 511}, 188: {512, 674, 107, 269, 431, 593, 26, 188, 350}, 189: {513, 675, 108, 270, 432, 594, 27, 189, 351},
        190: {352, 514, 676, 109, 271, 433, 595, 28, 190}, 191: {353, 515, 677, 110, 272, 434, 596, 29, 191}, 192: {192, 354, 516, 678, 111, 273, 435, 597, 30},
        193: {193, 355, 517, 679, 112, 274, 436, 598, 31}, 194: {32, 194, 356, 518, 680, 113, 275, 437, 599}, 195: {33, 195, 357, 519, 681, 114, 276, 438, 600},
        196: {34, 196, 358, 520, 682, 115, 277, 439, 601}, 197: {35, 197, 359, 521, 683, 116, 278, 440, 602}, 198: {36, 198, 360, 522, 684, 117, 279, 441, 603},
        199: {37, 199, 361, 523, 685, 118, 280, 442, 604}, 200: {38, 200, 362, 524, 686, 119, 281, 443, 605}, 201: {39, 201, 363, 525, 687, 120, 282, 444, 606},
        202: {40, 202, 364, 526, 688, 121, 283, 445, 607}, 203: {608, 41, 203, 365, 527, 689, 122, 284, 446}, 204: {609, 42, 204, 366, 528, 690, 123, 285, 447},
        205: {448, 610, 43, 205, 367, 529, 691, 124, 286}, 206: {449, 611, 44, 206, 368, 530, 692, 125, 287}, 207: {288, 450, 612, 45, 207, 369, 531, 693, 126},
        208: {289, 451, 613, 46, 208, 370, 532, 694, 127}, 209: {128, 290, 452, 614, 47, 209, 371, 533, 695}, 210: {129, 291, 453, 615, 48, 210, 372, 534, 696},
        211: {130, 292, 454, 616, 49, 211, 373, 535, 697}, 212: {131, 293, 455, 617, 50, 212, 374, 536, 698}, 213: {132, 294, 456, 618, 51, 213, 375, 537, 699},
        214: {133, 295, 457, 619, 52, 214, 376, 538, 700}, 215: {134, 296, 458, 620, 53, 215, 377, 539, 701}, 216: {135, 297, 459, 621, 54, 216, 378, 540, 702},
        217: {136, 298, 460, 622, 55, 217, 379, 541, 703}, 218: {704, 137, 299, 461, 623, 56, 218, 380, 542}, 219: {705, 138, 300, 462, 624, 57, 219, 381, 543},
        220: {544, 706, 139, 301, 463, 625, 58, 220, 382}, 221: {545, 707, 140, 302, 464, 626, 59, 221, 383}, 222: {384, 546, 708, 141, 303, 465, 627, 60, 222},
        223: {385, 547, 709, 142, 304, 466, 628, 61, 223}, 224: {224, 386, 548, 710, 143, 305, 467, 629, 62}, 225: {225, 387, 549, 711, 144, 306, 468, 630, 63},
        226: {64, 226, 388, 550, 712, 145, 307, 469, 631}, 227: {65, 227, 389, 551, 713, 146, 308, 470, 632}, 228: {66, 228, 390, 552, 714, 147, 309, 471, 633},
        229: {67, 229, 391, 553, 715, 148, 310, 472, 634}, 230: {68, 230, 392, 554, 716, 149, 311, 473, 635}, 231: {69, 231, 393, 555, 717, 150, 312, 474, 636},
        232: {70, 232, 394, 556, 718, 151, 313, 475, 637}, 233: {71, 233, 395, 557, 719, 152, 314, 476, 638}, 234: {72, 234, 396, 558, 720, 153, 315, 477, 639},
        235: {640, 73, 235, 397, 559, 721, 154, 316, 478}, 236: {641, 74, 236, 398, 560, 722, 155, 317, 479}, 237: {480, 642, 75, 237, 399, 561, 723, 156, 318},
        238: {481, 643, 76, 238, 400, 562, 724, 157, 319}, 239: {320, 482, 644, 77, 239, 401, 563, 725, 158}, 240: {321, 483, 645, 78, 240, 402, 564, 726, 159},
        241: {160, 322, 484, 646, 79, 241, 403, 565, 727}, 242: {161, 323, 485, 647, 80, 242, 404, 566, 728}, 243: {0, 162, 99, 9, 171, 81, 18, 180, 90},
        244: {1, 163, 100, 10, 172, 82, 19, 181, 91}, 245: {2, 164, 101, 11, 173, 83, 20, 182, 92}, 246: {3, 165, 102, 12, 174, 84, 21, 183, 93},
        247: {4, 166, 103, 13, 175, 85, 22, 184, 94}, 248: {5, 167, 104, 14, 176, 86, 23, 185, 95}, 249: {96, 6, 168, 105, 15, 177, 87, 24, 186},
        250: {97, 7, 169, 106, 16, 178, 88, 25, 187}, 251: {98, 8, 170, 107, 17, 179, 89, 26, 188}, 252: {36, 198, 108, 45, 207, 117, 27, 189, 126},
        253: {37, 199, 109, 46, 208, 118, 28, 190, 127}, 254: {128, 38, 200, 110, 47, 209, 119, 29, 191}, 255: {192, 129, 39, 201, 111, 48, 210, 120, 30},
        256: {193, 130, 40, 202, 112, 49, 211, 121, 31}, 257: {32, 194, 131, 41, 203, 113, 50, 212, 122}, 258: {33, 195, 132, 42, 204, 114, 51, 213, 123},
        259: {34, 196, 133, 43, 205, 115, 52, 214, 124}, 260: {35, 197, 134, 44, 206, 116, 53, 215, 125}, 261: {225, 135, 72, 234, 144, 54, 216, 153, 63},
        262: {64, 226, 136, 73, 235, 145, 55, 217, 154}, 263: {65, 227, 137, 74, 236, 146, 56, 218, 155}, 264: {66, 228, 138, 75, 237, 147, 57, 219, 156},
        265: {67, 229, 139, 76, 238, 148, 58, 220, 157}, 266: {68, 230, 140, 77, 239, 149, 59, 221, 158}, 267: {69, 231, 141, 78, 240, 150, 60, 222, 159},
        268: {160, 70, 232, 142, 79, 241, 151, 61, 223}, 269: {224, 161, 71, 233, 143, 80, 242, 152, 62}, 270: {324, 261, 423, 333, 243, 405, 342, 252, 414},
        271: {325, 262, 424, 334, 244, 406, 343, 253, 415}, 272: {416, 326, 263, 425, 335, 245, 407, 344, 254}, 273: {417, 327, 264, 426, 336, 246, 408, 345, 255},
        274: {256, 418, 328, 265, 427, 337, 247, 409, 346}, 275: {257, 419, 329, 266, 428, 338, 248, 410, 347}, 276: {258, 420, 330, 267, 429, 339, 249, 411, 348},
        277: {259, 421, 331, 268, 430, 340, 250, 412, 349}, 278: {260, 422, 332, 269, 431, 341, 251, 413, 350}, 279: {288, 450, 360, 270, 432, 369, 279, 441, 351},
        280: {352, 289, 451, 361, 271, 433, 370, 280, 442}, 281: {353, 290, 452, 362, 272, 434, 371, 281, 443}, 282: {354, 291, 453, 363, 273, 435, 372, 282, 444},
        283: {355, 292, 454, 364, 274, 436, 373, 283, 445}, 284: {356, 293, 455, 365, 275, 437, 374, 284, 446}, 285: {357, 294, 456, 366, 276, 438, 375, 285, 447},
        286: {448, 358, 295, 457, 367, 277, 439, 376, 286}, 287: {449, 359, 296, 458, 368, 278, 440, 377, 287}, 288: {387, 297, 459, 396, 306, 468, 378, 315, 477},
        289: {388, 298, 460, 397, 307, 469, 379, 316, 478}, 290: {389, 299, 461, 398, 308, 470, 380, 317, 479}, 291: {480, 390, 300, 462, 399, 309, 471, 381, 318},
        292: {481, 391, 301, 463, 400, 310, 472, 382, 319}, 293: {320, 482, 392, 302, 464, 401, 311, 473, 383}, 294: {384, 321, 483, 393, 303, 465, 402, 312, 474},
        295: {385, 322, 484, 394, 304, 466, 403, 313, 475}, 296: {386, 323, 485, 395, 305, 467, 404, 314, 476}, 297: {576, 486, 648, 585, 495, 657, 567, 504, 666},
        298: {577, 487, 649, 586, 496, 658, 568, 505, 667}, 299: {578, 488, 650, 587, 497, 659, 569, 506, 668}, 300: {579, 489, 651, 588, 498, 660, 570, 507, 669},
        301: {580, 490, 652, 589, 499, 661, 571, 508, 670}, 302: {581, 491, 653, 590, 500, 662, 572, 509, 671}, 303: {672, 582, 492, 654, 591, 501, 663, 573, 510},
        304: {673, 583, 493, 655, 592, 502, 664, 574, 511}, 305: {512, 674, 584, 494, 656, 593, 503, 665, 575}, 306: {513, 675, 612, 522, 684, 594, 531, 693, 603},
        307: {514, 676, 613, 523, 685, 595, 532, 694, 604}, 308: {515, 677, 614, 524, 686, 596, 533, 695, 605}, 309: {516, 678, 615, 525, 687, 597, 534, 696, 606},
        310: {517, 679, 616, 526, 688, 598, 535, 697, 607}, 311: {608, 518, 680, 617, 527, 689, 599, 536, 698}, 312: {609, 519, 681, 618, 528, 690, 600, 537, 699},
        313: {610, 520, 682, 619, 529, 691, 601, 538, 700}, 314: {611, 521, 683, 620, 530, 692, 602, 539, 701}, 315: {549, 711, 621, 558, 720, 630, 540, 702, 639},
        316: {640, 550, 712, 622, 559, 721, 631, 541, 703}, 317: {704, 641, 551, 713, 623, 560, 722, 632, 542}, 318: {705, 642, 552, 714, 624, 561, 723, 633, 543},
        319: {544, 706, 643, 553, 715, 625, 562, 724, 634}, 320: {545, 707, 644, 554, 716, 626, 563, 725, 635}, 321: {546, 708, 645, 555, 717, 627, 564, 726, 636},
        322: {547, 709, 646, 556, 718, 628, 565, 727, 637}, 323: {548, 710, 647, 557, 719, 629, 566, 728, 638}}

    rows = {
        0: (0, 81, 162, 243),
        1: (0, 82, 163, 244), 2: (0, 83, 164, 245), 3: (0, 84, 165, 246), 4: (0, 85, 166, 247), 5: (0, 86, 167, 248),
        6: (0, 87, 168, 249), 7: (0, 88, 169, 250), 8: (0, 89, 170, 251), 9: (1, 81, 171, 243), 10: (1, 82, 172, 244),
        11: (1, 83, 173, 245), 12: (1, 84, 174, 246), 13: (1, 85, 175, 247), 14: (1, 86, 176, 248), 15: (1, 87, 177, 249),
        16: (1, 88, 178, 250), 17: (1, 89, 179, 251), 18: (2, 81, 180, 243), 19: (2, 82, 181, 244), 20: (2, 83, 182, 245),
        21: (2, 84, 183, 246), 22: (2, 85, 184, 247), 23: (2, 86, 185, 248), 24: (2, 87, 186, 249), 25: (2, 88, 187, 250),
        26: (2, 89, 188, 251), 27: (3, 81, 189, 252), 28: (3, 82, 190, 253), 29: (3, 83, 191, 254), 30: (3, 84, 192, 255),
        31: (3, 85, 193, 256), 32: (3, 86, 194, 257), 33: (3, 87, 195, 258), 34: (3, 88, 196, 259), 35: (3, 89, 197, 260),
        36: (4, 81, 198, 252), 37: (4, 82, 199, 253), 38: (4, 83, 200, 254), 39: (4, 84, 201, 255), 40: (4, 85, 202, 256),
        41: (4, 86, 203, 257), 42: (4, 87, 204, 258), 43: (4, 88, 205, 259), 44: (4, 89, 206, 260), 45: (5, 81, 207, 252),
        46: (5, 82, 208, 253), 47: (5, 83, 209, 254), 48: (5, 84, 210, 255), 49: (5, 85, 211, 256), 50: (5, 86, 212, 257),
        51: (5, 87, 213, 258), 52: (5, 88, 214, 259), 53: (5, 89, 215, 260), 54: (6, 81, 216, 261), 55: (6, 82, 217, 262),
        56: (6, 83, 218, 263), 57: (6, 84, 219, 264), 58: (6, 85, 220, 265), 59: (6, 86, 221, 266), 60: (6, 87, 222, 267),
        61: (6, 88, 223, 268), 62: (6, 89, 224, 269), 63: (7, 81, 225, 261), 64: (7, 82, 226, 262), 65: (7, 83, 227, 263),
        66: (7, 84, 228, 264), 67: (7, 85, 229, 265), 68: (7, 86, 230, 266), 69: (7, 87, 231, 267), 70: (7, 88, 232, 268),
        71: (7, 89, 233, 269), 72: (8, 81, 234, 261), 73: (8, 82, 235, 262), 74: (8, 83, 236, 263), 75: (8, 84, 237, 264),
        76: (8, 85, 238, 265), 77: (8, 86, 239, 266), 78: (8, 87, 240, 267), 79: (8, 88, 241, 268), 80: (8, 89, 242, 269),
        81: (9, 90, 162, 243), 82: (9, 91, 163, 244), 83: (9, 92, 164, 245), 84: (9, 93, 165, 246), 85: (9, 94, 166, 247),
        86: (9, 95, 167, 248), 87: (9, 96, 168, 249), 88: (9, 97, 169, 250), 89: (9, 98, 170, 251), 90: (10, 90, 171, 243),
        91: (10, 91, 172, 244), 92: (10, 92, 173, 245), 93: (10, 93, 174, 246), 94: (10, 94, 175, 247), 95: (10, 95, 176, 248),
        96: (10, 96, 177, 249), 97: (10, 97, 178, 250), 98: (10, 98, 179, 251), 99: (11, 90, 180, 243), 100: (11, 91, 181, 244),
        101: (11, 92, 182, 245), 102: (11, 93, 183, 246), 103: (11, 94, 184, 247), 104: (11, 95, 185, 248), 105: (11, 96, 186, 249),
        106: (11, 97, 187, 250), 107: (11, 98, 188, 251), 108: (12, 90, 189, 252), 109: (12, 91, 190, 253), 110: (12, 92, 191, 254),
        111: (12, 93, 192, 255), 112: (12, 94, 193, 256), 113: (12, 95, 194, 257), 114: (12, 96, 195, 258), 115: (12, 97, 196, 259),
        116: (12, 98, 197, 260), 117: (13, 90, 198, 252), 118: (13, 91, 199, 253), 119: (13, 92, 200, 254), 120: (13, 93, 201, 255),
        121: (13, 94, 202, 256), 122: (13, 95, 203, 257), 123: (13, 96, 204, 258), 124: (13, 97, 205, 259), 125: (13, 98, 206, 260),
        126: (14, 90, 207, 252), 127: (14, 91, 208, 253), 128: (14, 92, 209, 254), 129: (14, 93, 210, 255), 130: (14, 94, 211, 256),
        131: (14, 95, 212, 257), 132: (14, 96, 213, 258), 133: (14, 97, 214, 259), 134: (14, 98, 215, 260), 135: (15, 90, 216, 261),
        136: (15, 91, 217, 262), 137: (15, 92, 218, 263), 138: (15, 93, 219, 264), 139: (15, 94, 220, 265), 140: (15, 95, 221, 266),
        141: (15, 96, 222, 267), 142: (15, 97, 223, 268), 143: (15, 98, 224, 269), 144: (16, 90, 225, 261), 145: (16, 91, 226, 262),
        146: (16, 92, 227, 263), 147: (16, 93, 228, 264), 148: (16, 94, 229, 265), 149: (16, 95, 230, 266), 150: (16, 96, 231, 267),
        151: (16, 97, 232, 268), 152: (16, 98, 233, 269), 153: (17, 90, 234, 261), 154: (17, 91, 235, 262), 155: (17, 92, 236, 263),
        156: (17, 93, 237, 264), 157: (17, 94, 238, 265), 158: (17, 95, 239, 266), 159: (17, 96, 240, 267), 160: (17, 97, 241, 268),
        161: (17, 98, 242, 269), 162: (18, 99, 162, 243), 163: (18, 100, 163, 244), 164: (18, 101, 164, 245), 165: (18, 102, 165, 246),
        166: (18, 103, 166, 247), 167: (18, 104, 167, 248), 168: (18, 105, 168, 249), 169: (18, 106, 169, 250), 170: (18, 107, 170, 251),
        171: (19, 99, 171, 243), 172: (19, 100, 172, 244), 173: (19, 101, 173, 245), 174: (19, 102, 174, 246), 175: (19, 103, 175, 247),
        176: (19, 104, 176, 248), 177: (19, 105, 177, 249), 178: (19, 106, 178, 250), 179: (19, 107, 179, 251), 180: (20, 99, 180, 243),
        181: (20, 100, 181, 244), 182: (20, 101, 182, 245), 183: (20, 102, 183, 246), 184: (20, 103, 184, 247), 185: (20, 104, 185, 248),
        186: (20, 105, 186, 249), 187: (20, 106, 187, 250), 188: (20, 107, 188, 251), 189: (21, 99, 189, 252), 190: (21, 100, 190, 253),
        191: (21, 101, 191, 254), 192: (21, 102, 192, 255), 193: (21, 103, 193, 256), 194: (21, 104, 194, 257), 195: (21, 105, 195, 258),
        196: (21, 106, 196, 259), 197: (21, 107, 197, 260), 198: (22, 99, 198, 252), 199: (22, 100, 199, 253), 200: (22, 101, 200, 254),
        201: (22, 102, 201, 255), 202: (22, 103, 202, 256), 203: (22, 104, 203, 257), 204: (22, 105, 204, 258), 205: (22, 106, 205, 259),
        206: (22, 107, 206, 260), 207: (23, 99, 207, 252), 208: (23, 100, 208, 253), 209: (23, 101, 209, 254), 210: (23, 102, 210, 255),
        211: (23, 103, 211, 256), 212: (23, 104, 212, 257), 213: (23, 105, 213, 258), 214: (23, 106, 214, 259), 215: (23, 107, 215, 260),
        216: (24, 99, 216, 261), 217: (24, 100, 217, 262), 218: (24, 101, 218, 263), 219: (24, 102, 219, 264), 220: (24, 103, 220, 265),
        221: (24, 104, 221, 266), 222: (24, 105, 222, 267), 223: (24, 106, 223, 268), 224: (24, 107, 224, 269), 225: (25, 99, 225, 261),
        226: (25, 100, 226, 262), 227: (25, 101, 227, 263), 228: (25, 102, 228, 264), 229: (25, 103, 229, 265), 230: (25, 104, 230, 266),
        231: (25, 105, 231, 267), 232: (25, 106, 232, 268), 233: (25, 107, 233, 269), 234: (26, 99, 234, 261), 235: (26, 100, 235, 262),
        236: (26, 101, 236, 263), 237: (26, 102, 237, 264), 238: (26, 103, 238, 265), 239: (26, 104, 239, 266), 240: (26, 105, 240, 267),
        241: (26, 106, 241, 268), 242: (26, 107, 242, 269), 243: (27, 108, 162, 270), 244: (27, 109, 163, 271), 245: (27, 110, 164, 272),
        246: (27, 111, 165, 273), 247: (27, 112, 166, 274), 248: (27, 113, 167, 275), 249: (27, 114, 168, 276), 250: (27, 115, 169, 277),
        251: (27, 116, 170, 278), 252: (28, 108, 171, 270), 253: (28, 109, 172, 271), 254: (28, 110, 173, 272), 255: (28, 111, 174, 273),
        256: (28, 112, 175, 274), 257: (28, 113, 176, 275), 258: (28, 114, 177, 276), 259: (28, 115, 178, 277), 260: (28, 116, 179, 278),
        261: (29, 108, 180, 270), 262: (29, 109, 181, 271), 263: (29, 110, 182, 272), 264: (29, 111, 183, 273), 265: (29, 112, 184, 274),
        266: (29, 113, 185, 275), 267: (29, 114, 186, 276), 268: (29, 115, 187, 277), 269: (29, 116, 188, 278), 270: (30, 108, 189, 279),
        271: (30, 109, 190, 280), 272: (30, 110, 191, 281), 273: (30, 111, 192, 282), 274: (30, 112, 193, 283), 275: (30, 113, 194, 284),
        276: (30, 114, 195, 285), 277: (30, 115, 196, 286), 278: (30, 116, 197, 287), 279: (31, 108, 198, 279), 280: (31, 109, 199, 280),
        281: (31, 110, 200, 281), 282: (31, 111, 201, 282), 283: (31, 112, 202, 283), 284: (31, 113, 203, 284), 285: (31, 114, 204, 285),
        286: (31, 115, 205, 286), 287: (31, 116, 206, 287), 288: (32, 108, 207, 279), 289: (32, 109, 208, 280), 290: (32, 110, 209, 281),
        291: (32, 111, 210, 282), 292: (32, 112, 211, 283), 293: (32, 113, 212, 284), 294: (32, 114, 213, 285), 295: (32, 115, 214, 286),
        296: (32, 116, 215, 287), 297: (33, 108, 216, 288), 298: (33, 109, 217, 289), 299: (33, 110, 218, 290), 300: (33, 111, 219, 291),
        301: (33, 112, 220, 292), 302: (33, 113, 221, 293), 303: (33, 114, 222, 294), 304: (33, 115, 223, 295), 305: (33, 116, 224, 296),
        306: (34, 108, 225, 288), 307: (34, 109, 226, 289), 308: (34, 110, 227, 290), 309: (34, 111, 228, 291), 310: (34, 112, 229, 292),
        311: (34, 113, 230, 293), 312: (34, 114, 231, 294), 313: (34, 115, 232, 295), 314: (34, 116, 233, 296), 315: (35, 108, 234, 288),
        316: (35, 109, 235, 289), 317: (35, 110, 236, 290), 318: (35, 111, 237, 291), 319: (35, 112, 238, 292), 320: (35, 113, 239, 293),
        321: (35, 114, 240, 294), 322: (35, 115, 241, 295), 323: (35, 116, 242, 296), 324: (36, 117, 162, 270), 325: (36, 118, 163, 271),
        326: (36, 119, 164, 272), 327: (36, 120, 165, 273), 328: (36, 121, 166, 274), 329: (36, 122, 167, 275), 330: (36, 123, 168, 276),
        331: (36, 124, 169, 277), 332: (36, 125, 170, 278), 333: (37, 117, 171, 270), 334: (37, 118, 172, 271), 335: (37, 119, 173, 272),
        336: (37, 120, 174, 273), 337: (37, 121, 175, 274), 338: (37, 122, 176, 275), 339: (37, 123, 177, 276), 340: (37, 124, 178, 277),
        341: (37, 125, 179, 278), 342: (38, 117, 180, 270), 343: (38, 118, 181, 271), 344: (38, 119, 182, 272), 345: (38, 120, 183, 273),
        346: (38, 121, 184, 274), 347: (38, 122, 185, 275), 348: (38, 123, 186, 276), 349: (38, 124, 187, 277), 350: (38, 125, 188, 278),
        351: (39, 117, 189, 279), 352: (39, 118, 190, 280), 353: (39, 119, 191, 281), 354: (39, 120, 192, 282), 355: (39, 121, 193, 283),
        356: (39, 122, 194, 284), 357: (39, 123, 195, 285), 358: (39, 124, 196, 286), 359: (39, 125, 197, 287), 360: (40, 117, 198, 279),
        361: (40, 118, 199, 280), 362: (40, 119, 200, 281), 363: (40, 120, 201, 282), 364: (40, 121, 202, 283), 365: (40, 122, 203, 284),
        366: (40, 123, 204, 285), 367: (40, 124, 205, 286), 368: (40, 125, 206, 287), 369: (41, 117, 207, 279), 370: (41, 118, 208, 280),
        371: (41, 119, 209, 281), 372: (41, 120, 210, 282), 373: (41, 121, 211, 283), 374: (41, 122, 212, 284), 375: (41, 123, 213, 285),
        376: (41, 124, 214, 286), 377: (41, 125, 215, 287), 378: (42, 117, 216, 288), 379: (42, 118, 217, 289), 380: (42, 119, 218, 290),
        381: (42, 120, 219, 291), 382: (42, 121, 220, 292), 383: (42, 122, 221, 293), 384: (42, 123, 222, 294), 385: (42, 124, 223, 295),
        386: (42, 125, 224, 296), 387: (43, 117, 225, 288), 388: (43, 118, 226, 289), 389: (43, 119, 227, 290), 390: (43, 120, 228, 291),
        391: (43, 121, 229, 292), 392: (43, 122, 230, 293), 393: (43, 123, 231, 294), 394: (43, 124, 232, 295), 395: (43, 125, 233, 296),
        396: (44, 117, 234, 288), 397: (44, 118, 235, 289), 398: (44, 119, 236, 290), 399: (44, 120, 237, 291), 400: (44, 121, 238, 292),
        401: (44, 122, 239, 293), 402: (44, 123, 240, 294), 403: (44, 124, 241, 295), 404: (44, 125, 242, 296), 405: (45, 126, 162, 270),
        406: (45, 127, 163, 271), 407: (45, 128, 164, 272), 408: (45, 129, 165, 273), 409: (45, 130, 166, 274), 410: (45, 131, 167, 275),
        411: (45, 132, 168, 276), 412: (45, 133, 169, 277), 413: (45, 134, 170, 278), 414: (46, 126, 171, 270), 415: (46, 127, 172, 271),
        416: (46, 128, 173, 272), 417: (46, 129, 174, 273), 418: (46, 130, 175, 274), 419: (46, 131, 176, 275), 420: (46, 132, 177, 276),
        421: (46, 133, 178, 277), 422: (46, 134, 179, 278), 423: (47, 126, 180, 270), 424: (47, 127, 181, 271), 425: (47, 128, 182, 272),
        426: (47, 129, 183, 273), 427: (47, 130, 184, 274), 428: (47, 131, 185, 275), 429: (47, 132, 186, 276), 430: (47, 133, 187, 277),
        431: (47, 134, 188, 278), 432: (48, 126, 189, 279), 433: (48, 127, 190, 280), 434: (48, 128, 191, 281), 435: (48, 129, 192, 282),
        436: (48, 130, 193, 283), 437: (48, 131, 194, 284), 438: (48, 132, 195, 285), 439: (48, 133, 196, 286), 440: (48, 134, 197, 287),
        441: (49, 126, 198, 279), 442: (49, 127, 199, 280), 443: (49, 128, 200, 281), 444: (49, 129, 201, 282), 445: (49, 130, 202, 283),
        446: (49, 131, 203, 284), 447: (49, 132, 204, 285), 448: (49, 133, 205, 286), 449: (49, 134, 206, 287), 450: (50, 126, 207, 279),
        451: (50, 127, 208, 280), 452: (50, 128, 209, 281), 453: (50, 129, 210, 282), 454: (50, 130, 211, 283), 455: (50, 131, 212, 284),
        456: (50, 132, 213, 285), 457: (50, 133, 214, 286), 458: (50, 134, 215, 287), 459: (51, 126, 216, 288), 460: (51, 127, 217, 289),
        461: (51, 128, 218, 290), 462: (51, 129, 219, 291), 463: (51, 130, 220, 292), 464: (51, 131, 221, 293), 465: (51, 132, 222, 294),
        466: (51, 133, 223, 295), 467: (51, 134, 224, 296), 468: (52, 126, 225, 288), 469: (52, 127, 226, 289), 470: (52, 128, 227, 290),
        471: (52, 129, 228, 291), 472: (52, 130, 229, 292), 473: (52, 131, 230, 293), 474: (52, 132, 231, 294), 475: (52, 133, 232, 295),
        476: (52, 134, 233, 296), 477: (53, 126, 234, 288), 478: (53, 127, 235, 289), 479: (53, 128, 236, 290), 480: (53, 129, 237, 291),
        481: (53, 130, 238, 292), 482: (53, 131, 239, 293), 483: (53, 132, 240, 294), 484: (53, 133, 241, 295), 485: (53, 134, 242, 296),
        486: (54, 135, 162, 297), 487: (54, 136, 163, 298), 488: (54, 137, 164, 299), 489: (54, 138, 165, 300), 490: (54, 139, 166, 301),
        491: (54, 140, 167, 302), 492: (54, 141, 168, 303), 493: (54, 142, 169, 304), 494: (54, 143, 170, 305), 495: (55, 135, 171, 297),
        496: (55, 136, 172, 298), 497: (55, 137, 173, 299), 498: (55, 138, 174, 300), 499: (55, 139, 175, 301), 500: (55, 140, 176, 302),
        501: (55, 141, 177, 303), 502: (55, 142, 178, 304), 503: (55, 143, 179, 305), 504: (56, 135, 180, 297), 505: (56, 136, 181, 298),
        506: (56, 137, 182, 299), 507: (56, 138, 183, 300), 508: (56, 139, 184, 301), 509: (56, 140, 185, 302), 510: (56, 141, 186, 303),
        511: (56, 142, 187, 304), 512: (56, 143, 188, 305), 513: (57, 135, 189, 306), 514: (57, 136, 190, 307), 515: (57, 137, 191, 308),
        516: (57, 138, 192, 309), 517: (57, 139, 193, 310), 518: (57, 140, 194, 311), 519: (57, 141, 195, 312), 520: (57, 142, 196, 313),
        521: (57, 143, 197, 314), 522: (58, 135, 198, 306), 523: (58, 136, 199, 307), 524: (58, 137, 200, 308), 525: (58, 138, 201, 309),
        526: (58, 139, 202, 310), 527: (58, 140, 203, 311), 528: (58, 141, 204, 312), 529: (58, 142, 205, 313), 530: (58, 143, 206, 314),
        531: (59, 135, 207, 306), 532: (59, 136, 208, 307), 533: (59, 137, 209, 308), 534: (59, 138, 210, 309), 535: (59, 139, 211, 310),
        536: (59, 140, 212, 311), 537: (59, 141, 213, 312), 538: (59, 142, 214, 313), 539: (59, 143, 215, 314), 540: (60, 135, 216, 315),
        541: (60, 136, 217, 316), 542: (60, 137, 218, 317), 543: (60, 138, 219, 318), 544: (60, 139, 220, 319), 545: (60, 140, 221, 320),
        546: (60, 141, 222, 321), 547: (60, 142, 223, 322), 548: (60, 143, 224, 323), 549: (61, 135, 225, 315), 550: (61, 136, 226, 316),
        551: (61, 137, 227, 317), 552: (61, 138, 228, 318), 553: (61, 139, 229, 319), 554: (61, 140, 230, 320), 555: (61, 141, 231, 321),
        556: (61, 142, 232, 322), 557: (61, 143, 233, 323), 558: (62, 135, 234, 315), 559: (62, 136, 235, 316), 560: (62, 137, 236, 317),
        561: (62, 138, 237, 318), 562: (62, 139, 238, 319), 563: (62, 140, 239, 320), 564: (62, 141, 240, 321), 565: (62, 142, 241, 322),
        566: (62, 143, 242, 323), 567: (63, 144, 162, 297), 568: (63, 145, 163, 298), 569: (63, 146, 164, 299), 570: (63, 147, 165, 300),
        571: (63, 148, 166, 301), 572: (63, 149, 167, 302), 573: (63, 150, 168, 303), 574: (63, 151, 169, 304), 575: (63, 152, 170, 305),
        576: (64, 144, 171, 297), 577: (64, 145, 172, 298), 578: (64, 146, 173, 299), 579: (64, 147, 174, 300), 580: (64, 148, 175, 301),
        581: (64, 149, 176, 302), 582: (64, 150, 177, 303), 583: (64, 151, 178, 304), 584: (64, 152, 179, 305), 585: (65, 144, 180, 297),
        586: (65, 145, 181, 298), 587: (65, 146, 182, 299), 588: (65, 147, 183, 300), 589: (65, 148, 184, 301), 590: (65, 149, 185, 302),
        591: (65, 150, 186, 303), 592: (65, 151, 187, 304), 593: (65, 152, 188, 305), 594: (66, 144, 189, 306), 595: (66, 145, 190, 307),
        596: (66, 146, 191, 308), 597: (66, 147, 192, 309), 598: (66, 148, 193, 310), 599: (66, 149, 194, 311), 600: (66, 150, 195, 312),
        601: (66, 151, 196, 313), 602: (66, 152, 197, 314), 603: (67, 144, 198, 306), 604: (67, 145, 199, 307), 605: (67, 146, 200, 308),
        606: (67, 147, 201, 309), 607: (67, 148, 202, 310), 608: (67, 149, 203, 311), 609: (67, 150, 204, 312), 610: (67, 151, 205, 313),
        611: (67, 152, 206, 314), 612: (68, 144, 207, 306), 613: (68, 145, 208, 307), 614: (68, 146, 209, 308), 615: (68, 147, 210, 309),
        616: (68, 148, 211, 310), 617: (68, 149, 212, 311), 618: (68, 150, 213, 312), 619: (68, 151, 214, 313), 620: (68, 152, 215, 314),
        621: (69, 144, 216, 315), 622: (69, 145, 217, 316), 623: (69, 146, 218, 317), 624: (69, 147, 219, 318), 625: (69, 148, 220, 319),
        626: (69, 149, 221, 320), 627: (69, 150, 222, 321), 628: (69, 151, 223, 322), 629: (69, 152, 224, 323), 630: (70, 144, 225, 315),
        631: (70, 145, 226, 316), 632: (70, 146, 227, 317), 633: (70, 147, 228, 318), 634: (70, 148, 229, 319), 635: (70, 149, 230, 320),
        636: (70, 150, 231, 321), 637: (70, 151, 232, 322), 638: (70, 152, 233, 323), 639: (71, 144, 234, 315), 640: (71, 145, 235, 316),
        641: (71, 146, 236, 317), 642: (71, 147, 237, 318), 643: (71, 148, 238, 319), 644: (71, 149, 239, 320), 645: (71, 150, 240, 321),
        646: (71, 151, 241, 322), 647: (71, 152, 242, 323), 648: (72, 153, 162, 297), 649: (72, 154, 163, 298), 650: (72, 155, 164, 299),
        651: (72, 156, 165, 300), 652: (72, 157, 166, 301), 653: (72, 158, 167, 302), 654: (72, 159, 168, 303), 655: (72, 160, 169, 304),
        656: (72, 161, 170, 305), 657: (73, 153, 171, 297), 658: (73, 154, 172, 298), 659: (73, 155, 173, 299), 660: (73, 156, 174, 300),
        661: (73, 157, 175, 301), 662: (73, 158, 176, 302), 663: (73, 159, 177, 303), 664: (73, 160, 178, 304), 665: (73, 161, 179, 305),
        666: (74, 153, 180, 297), 667: (74, 154, 181, 298), 668: (74, 155, 182, 299), 669: (74, 156, 183, 300), 670: (74, 157, 184, 301),
        671: (74, 158, 185, 302), 672: (74, 159, 186, 303), 673: (74, 160, 187, 304), 674: (74, 161, 188, 305), 675: (75, 153, 189, 306),
        676: (75, 154, 190, 307), 677: (75, 155, 191, 308), 678: (75, 156, 192, 309), 679: (75, 157, 193, 310), 680: (75, 158, 194, 311),
        681: (75, 159, 195, 312), 682: (75, 160, 196, 313), 683: (75, 161, 197, 314), 684: (76, 153, 198, 306), 685: (76, 154, 199, 307),
        686: (76, 155, 200, 308), 687: (76, 156, 201, 309), 688: (76, 157, 202, 310), 689: (76, 158, 203, 311), 690: (76, 159, 204, 312),
        691: (76, 160, 205, 313), 692: (76, 161, 206, 314), 693: (77, 153, 207, 306), 694: (77, 154, 208, 307), 695: (77, 155, 209, 308),
        696: (77, 156, 210, 309), 697: (77, 157, 211, 310), 698: (77, 158, 212, 311), 699: (77, 159, 213, 312), 700: (77, 160, 214, 313),
        701: (77, 161, 215, 314), 702: (78, 153, 216, 315), 703: (78, 154, 217, 316), 704: (78, 155, 218, 317), 705: (78, 156, 219, 318),
        706: (78, 157, 220, 319), 707: (78, 158, 221, 320), 708: (78, 159, 222, 321), 709: (78, 160, 223, 322), 710: (78, 161, 224, 323),
        711: (79, 153, 225, 315), 712: (79, 154, 226, 316), 713: (79, 155, 227, 317), 714: (79, 156, 228, 318), 715: (79, 157, 229, 319),
        716: (79, 158, 230, 320), 717: (79, 159, 231, 321), 718: (79, 160, 232, 322), 719: (79, 161, 233, 323), 720: (80, 153, 234, 315),
        721: (80, 154, 235, 316), 722: (80, 155, 236, 317), 723: (80, 156, 237, 318), 724: (80, 157, 238, 319), 725: (80, 158, 239, 320),
        726: (80, 159, 240, 321), 727: (80, 160, 241, 322), 728: (80, 161, 242, 323)}

    return columns, rows


def apply_mask(raw, columns, rows):
    results = [0] * 81

    for i, c in enumerate(raw):
        if c > '0':
            y = i // 9
            x = i % 9
            n = int(ord(c) - ord('1'))

            cover(columns, rows, y * 81 + x * 9 + n)

            results[i] = n

    return results


def search(columns, rows, results):
    # If there are no columns left - we found solution
    if not columns:
        return results

    # Find column with lowest number of links (simple heuristic to process cells with lowest number of possible values)
    c = min(columns, key=lambda c: len(columns[c]))

    # Traverse rows for a given column. Need to make a copy, because we're going to change it during cover/uncover
    # process
    for r in list(columns[c]):
        # Store value in the result
        results[r // 9] = r % 9

        # Cover the column, removing intersecting rows
        cols = cover(columns, rows, r)

        # Search for solution in reduced columns
        res = search(columns, rows, results)

        if res:
            return res

        # Didn't find anything, uncover and try other row
        uncover(columns, rows, r, cols)


def solve(raw):
    """
        Solve sudoku puzzle
    """
    columns, rows = gen_matrix()
    results = apply_mask(raw, columns, rows)
    return search(columns, rows, results)


# Various helpers, unrelated to actual solver
def test():
    #raw = '140035200725640003693218700036894000814570002000062000467000000381450006950000071'
    #raw = '002508700000000000701000506400020009000907000300010005108000603000000000007204800'
    #raw = '100030009020640080003200740200000000014000000000062800007000300080450020000000001'
    #raw = '020000000000600003074080000000003002080040010000500000000010780500009000000000040'
    #raw = '.....6....59.....82....8....45........3........6..3.54...325..6..................'
    raw = '100400009056009000000010060060000800500004090900005010070000200600001050000300000'
    solve(raw)


def bench():
    import timeit
    count = 50
    val = timeit.timeit('test()', setup='from __main__ import test', number=count)
    print val, val / count


# Entry point
if __name__ == '__main__':
    #bench()
    #test()
    import sys
    print dump(solve(sys.argv[1]))
